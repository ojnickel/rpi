LPSiteNotification=function(){var h,s=!1,t;t=function(a){var c=a.target,f=$('input:not([type]):visible,input[type="text"]:visible,input[type="email"]:visible,input[type="password"]:visible'),b;a:{b=0;for(var g=f.length;b<g;++b)if("password"===f[b].type&&f[b].value){b=!0;break a}b=!1}if(b){b=c;for(c=[];b&&b.parentElement&&b.parentElement!==h;)c.unshift(b.parentElement),b=b.parentElement;b=0;for(g=f.length;b<g;++b){var d=f[b];if(d.value)for(var d=d.parentElement,e=null;d;){"FORM"===d.nodeName&&(e=d);
var n=c.indexOf(d);if(-1<n){e?j({form:e,type:a.type}):j({genericForm:c[n],type:a.type});return}d=d.parentElement}}}};var j,u,v=["submit","click","keydown"],k={},l=!1;u=function(a,c){k[a]=c;l||(l=!0,setTimeout(function(){for(var a=0;a<v.length;++a){var b=v[a];if(k.hasOwnProperty(b)){k[b]();break}}l=!1;k={}},0))};j=function(a){var c=a.form||a.genericForm;if(c){for(var f=$(c).find('input:not([type]):visible,input[type="text"]:visible,input[type="email"]:visible,input[type="password"]:visible'),b=[],
g=!1,c=0;c<f.length;++c){var d=f[c];if(d.value){for(var e=d.type,n=d.value,j=d.id,k=d,h=["name","ng-model","data-reactid"],l={},p=0;p<h.length;++p){var m=k.getAttribute(h[p]);m&&(l[h[p]]=m)}e={type:e,value:n,id:j,attributes:l};"password"!==e.type&&"disc"===$(d).css("text-security")&&(e.type="password");d=e;"password"===d.type&&(g=!0);b.push(d)}}u(a.type,function(){g?(s=!0,bg.LPTabState.processPasswordSubmit({formData:{url:document.location.href,fields:b,formname:a.form?a.form.getAttribute("name"):
""},callback:q})):1===f.length&&bg.LPTabState.processUsernameSubmit(b[0])})}};var q,w=function(a){a.postSetup=function(){Topics.get(Topics.SITE_NOTIFICATION).publish(c)};var c=csTop.LPFrame.openDialog("contentScriptSite",a);c.css({top:10,right:10})};q=function(a){LPContentScriptTools.isUnloading()||(Topics.get(Topics.SITE_NOTIFICATION_STATE).publish(a),bg.get("LPContentScriptFeatures").new_save_site&&(a.formData?a.formData.basicAuthentication||!a.formExists:a.generatedPassword)&&(lp_gettld_url(window.location.href)===
lp_gettld_url(a.defaultData.url)?LPContentScriptTools.getFavicon(function(c){a.favicon=c;w(a)}):w(a)))};var x=function(a){for(;a;){if("FORM"===a.nodeName)return a;a=a.parentElement}return null},m,y=function(a){a=a.toLowerCase();return-1<a.indexOf("submit")||-1<a.indexOf("save")},r=function(a){a=a.attributes;for(var c=0;c<a.length;++c){var f=a[c];if(y(f.name)||y(f.value))return!0}return!1};m=function(a){if("INPUT"===a.nodeName)return"submit"===a.type?!0:"button"===a.type?r(a):!1;for(;0===a.getElementsByTagName("input").length;){if("BUTTON"===
a.nodeName)return"submit"===a.type||r(a);if(r(a))return!0;a=a.parentElement}return!1};var z=function(){var a=function(a){return function(b){if(!1!==b.isTrusted)try{a(b)}catch(c){console.log(c)}}},c=function(a,b){var c=x(a);c?j({form:c,type:b}):t({target:a,type:b})};document.addEventListener("submit",a(function(a){j({form:x(a.target),submit:!0,type:a.type})}),!0);document.addEventListener("click",a(function(a){m(a.target)&&c(a.target,a.type)}),!0);document.addEventListener("keydown",a(function(a){var b=
a.target;if(b!==h&&13===(a.keyCode||a.which))(m(b)||"INPUT"===b.nodeName)&&c(b,a.type)}),!0)};Topics.get(Topics.INITIALIZED).subscribe(function(){if(bg.get("lploggedin")){h=document.body;if(0<$('input:not([type]):visible,input[type="text"]:visible,input[type="email"]:visible,input[type="password"]:visible').length)z();else{var a=function(c){"INPUT"===c.target.nodeName&&(z(),document.removeEventListener("focus",a,!0))};document.addEventListener("focus",a,!0)}window===top&&bg.LPTabState.getSiteNotification({callback:q})}});
return{formExists:function(a,c){var f=0,b=setInterval(function(){++f;var g;a:{for(g=0;g<a.fields.length;++g){var d=a.fields[g];if("password"===d.type){var e;if(d.id)e=$(document.getElementById(d.id));else for(var h in d.attributes)if(e=$("input["+h+'="'+d.attributes[h]+'"]'),0<e.length)break;g=e&&0<e.length&&e.is(":visible")?a.passwordChangeForm?e.val()===d.value:!0:!1;break a}}g=!1}if(!g||4<f||!s)clearInterval(b),c(g)},1E3)}}}();
